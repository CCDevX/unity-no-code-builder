@use "sass:color";
@use "./variables" as *;

.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 1rem;
  padding: 1.4rem 2.4rem;
  border-radius: 1rem;
  border: none;
  font-weight: 700;
  font-family: $font-family, -apple-system, BlinkMacSystemFont, sans-serif;
  font-size: 1.6rem;
  letter-spacing: 0.02em;
  text-transform: uppercase;
  cursor: pointer;
  position: relative;
  white-space: nowrap;
  user-select: none;
  text-decoration: none;
  transition: all $transition-speed cubic-bezier(0.4, 0, 0.2, 1);
  backdrop-filter: blur(8px);

  // Shadow moderne par défaut
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1), 0 2px 4px rgba(0, 0, 0, 0.06),
    inset 0 1px 0 rgba(255, 255, 255, 0.1);

  // Focus amélioré
  &:focus-visible {
    outline: 3px solid rgba($accent-color, 0.4);
    outline-offset: 3px;
    z-index: 10;
  }

  // Désactive le double tap zoom sur iOS
  touch-action: manipulation;

  // ==========================================
  // BOUTON PRIMARY
  // ==========================================
  &-primary {
    background: linear-gradient(
      145deg,
      $accent-color 0%,
      color.adjust($accent-color, $lightness: -8%) 50%,
      color.adjust($accent-color, $lightness: -15%) 100%
    );
    color: white;
    border: 2px solid transparent;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
    box-shadow: 0 6px 20px rgba($accent-color, 0.3),
      0 2px 4px rgba(0, 0, 0, 0.06), inset 0 1px 0 rgba(255, 255, 255, 0.2);

    &:hover,
    &:focus-visible {
      background: linear-gradient(
        145deg,
        color.adjust($accent-color, $lightness: 5%) 0%,
        $accent-color 50%,
        color.adjust($accent-color, $lightness: -10%) 100%
      );
      transform: translateY(-0.4rem) scale(1.05);
      box-shadow: 0 12px 35px rgba($accent-color, 0.4),
        0 4px 8px rgba(0, 0, 0, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.3);
    }

    &:active {
      transform: translateY(-0.1rem) scale(1.02);
      transition: transform 0.1s ease;
    }
  }

  // ==========================================
  // BOUTON SECONDARY
  // ==========================================
  &-secondary {
    background: linear-gradient(
      145deg,
      color.adjust($bg-elevated, $lightness: 8%) 0%,
      $bg-elevated 50%,
      color.adjust($bg-elevated, $lightness: -3%) 100%
    );
    border: 2px solid rgba($accent-color, 0.3);
    color: $text-primary;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08),
      inset 0 1px 0 rgba(255, 255, 255, 0.1);

    &:hover,
    &:focus-visible {
      background: linear-gradient(
        145deg,
        color.adjust($bg-elevated, $lightness: 12%) 0%,
        color.adjust($bg-elevated, $lightness: 5%) 50%,
        $bg-elevated 100%
      );
      border-color: rgba($accent-color, 0.6);
      color: $accent-color;
      transform: translateY(-0.3rem) scale(1.03);
      box-shadow: 0 8px 25px rgba($accent-color, 0.15),
        0 0 0 1px rgba($accent-color, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.15);
    }

    &:active {
      transform: translateY(-0.1rem) scale(1.01);
    }
  }

  // ==========================================
  // BOUTON OUTLINE
  // ==========================================
  &-outline {
    background: transparent;
    border: 2px solid $accent-color;
    color: $accent-color;
    backdrop-filter: blur(5px);
    box-shadow: 0 2px 8px rgba($accent-color, 0.1),
      inset 0 0 0 1px rgba($accent-color, 0.05);

    &:hover,
    &:focus-visible {
      background: rgba($accent-color, 0.1);
      border-color: color.adjust($accent-color, $lightness: 10%);
      color: color.adjust($accent-color, $lightness: 10%);
      transform: translateY(-0.3rem) scale(1.03);
      box-shadow: 0 8px 25px rgba($accent-color, 0.2),
        inset 0 0 0 1px rgba($accent-color, 0.1);
      text-shadow: 0 0 10px rgba($accent-color, 0.3);
    }

    &:active {
      transform: translateY(-0.1rem) scale(1.01);
    }
  }

  // ==========================================
  // BOUTON GHOST
  // ==========================================
  &-ghost {
    background: transparent;
    border: 2px solid transparent;
    color: $text-secondary;
    box-shadow: none;

    &:hover,
    &:focus-visible {
      background: rgba($accent-color, 0.08);
      border-color: rgba($accent-color, 0.2);
      color: $accent-color;
      transform: translateY(-0.2rem) scale(1.02);
      box-shadow: 0 4px 15px rgba($accent-color, 0.1);
    }

    &:active {
      transform: scale(0.98);
    }
  }

  // ==========================================
  // BOUTON DANGER
  // ==========================================
  &-danger {
    background: linear-gradient(
      145deg,
      #e74c3c 0%,
      color.adjust(#e74c3c, $lightness: -8%) 50%,
      color.adjust(#e74c3c, $lightness: -15%) 100%
    );
    color: white;
    border: 2px solid transparent;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
    box-shadow: 0 6px 20px rgba(231, 76, 60, 0.3),
      inset 0 1px 0 rgba(255, 255, 255, 0.2);

    &:hover,
    &:focus-visible {
      background: linear-gradient(
        145deg,
        color.adjust(#e74c3c, $lightness: 5%) 0%,
        #e74c3c 50%,
        color.adjust(#e74c3c, $lightness: -10%) 100%
      );
      transform: translateY(-0.4rem) scale(1.05);
      box-shadow: 0 12px 35px rgba(231, 76, 60, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.3);
    }

    &:active {
      transform: translateY(-0.1rem) scale(1.02);
    }
  }

  // ==========================================
  // BOUTON SUCCESS
  // ==========================================
  &-success {
    background: linear-gradient(
      145deg,
      #2ecc71 0%,
      color.adjust(#2ecc71, $lightness: -8%) 50%,
      color.adjust(#2ecc71, $lightness: -15%) 100%
    );
    color: white;
    border: 2px solid transparent;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
    box-shadow: 0 6px 20px rgba(46, 204, 113, 0.3),
      inset 0 1px 0 rgba(255, 255, 255, 0.2);

    &:hover,
    &:focus-visible {
      background: linear-gradient(
        145deg,
        color.adjust(#2ecc71, $lightness: 5%) 0%,
        #2ecc71 50%,
        color.adjust(#2ecc71, $lightness: -10%) 100%
      );
      transform: translateY(-0.4rem) scale(1.05);
      box-shadow: 0 12px 35px rgba(46, 204, 113, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.3);
    }

    &:active {
      transform: translateY(-0.1rem) scale(1.02);
    }
  }

  // ==========================================
  // BOUTON ICON
  // ==========================================
  &-icon {
    background: linear-gradient(
      145deg,
      color.adjust($bg-elevated, $lightness: 5%) 0%,
      $bg-elevated 100%
    );
    border: 2px solid rgba($accent-color, 0.15);
    color: $text-secondary;
    font-size: 2rem;
    width: 5rem;
    height: 5rem;
    border-radius: 50%;
    padding: 0;
    text-transform: none;
    gap: 0;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08),
      inset 0 1px 0 rgba(255, 255, 255, 0.1);

    &:hover,
    &:focus-visible {
      background: linear-gradient(
        145deg,
        color.adjust($bg-elevated, $lightness: 10%) 0%,
        color.adjust($bg-elevated, $lightness: 5%) 100%
      );
      border-color: rgba($accent-color, 0.4);
      color: $accent-color;
      transform: translateY(-0.3rem) scale(1.1);
      box-shadow: 0 8px 25px rgba($accent-color, 0.15),
        inset 0 1px 0 rgba(255, 255, 255, 0.15);
    }

    &:active {
      transform: translateY(-0.1rem) scale(1.05);
    }

    // Variantes de taille
    &.sm {
      width: 4rem;
      height: 4rem;
      font-size: 1.6rem;
    }

    &.lg {
      width: 6rem;
      height: 6rem;
      font-size: 2.4rem;
    }

    &.xl {
      width: 7rem;
      height: 7rem;
      font-size: 2.8rem;
    }
  }

  // ==========================================
  // VARIANTES DE TAILLE
  // ==========================================
  &.sm {
    padding: 1rem 2rem;
    font-size: 1.4rem;
    border-radius: 0.8rem;
    gap: 0.8rem;
  }

  &.lg {
    padding: 2rem 3.5rem;
    font-size: 1.8rem;
    border-radius: 1.2rem;
    gap: 1.2rem;
  }

  &.xl {
    padding: 2.5rem 4rem;
    font-size: 2rem;
    border-radius: 1.5rem;
    gap: 1.5rem;
  }

  // ==========================================
  // VARIANTES DE LARGEUR
  // ==========================================
  &.full-width {
    width: 100%;
    justify-content: center;
  }

  &.auto-width {
    width: auto;
    min-width: auto;
  }

  // ==========================================
  // ÉTATS SPÉCIAUX
  // ==========================================

  // État loading
  &.loading {
    position: relative;
    color: transparent;
    pointer-events: none;
    overflow: hidden;

    // Spinner avec border animé
    border: 2px solid rgba($accent-color, 0.3);
    border-top: 2px solid $accent-color;
    animation: spin-button 1s linear infinite;
  }

  // État pulse pour attirer l'attention
  &.pulse {
    animation: pulse-glow 2s ease-in-out infinite;
  }

  // Bouton avec icône gauche
  &.icon-left {
    i {
      margin-right: 0.5rem;
      font-size: 0.9em;
    }
  }

  // Bouton avec icône droite
  &.icon-right {
    i {
      margin-left: 0.5rem;
      font-size: 0.9em;
    }
  }

  // ==========================================
  // ÉTAT DISABLED
  // ==========================================
  &:disabled,
  &[aria-disabled="true"],
  &.disabled {
    opacity: 0.5;
    pointer-events: none;
    filter: grayscale(50%);
    background: color.adjust($bg-elevated, $lightness: -5%) !important;
    color: $text-secondary !important;
    border-color: rgba($border-color, 0.5) !important;
    box-shadow: none !important;
    transform: none !important;
    cursor: not-allowed;
    animation: none !important;
  }

  // ==========================================
  // GROUPES DE BOUTONS
  // ==========================================
  &-group {
    display: inline-flex;
    border-radius: 1rem;
    overflow: hidden;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);

    .btn {
      border-radius: 0;
      margin: 0;
      border-right: 1px solid rgba(255, 255, 255, 0.2);

      &:first-child {
        border-top-left-radius: 1rem;
        border-bottom-left-radius: 1rem;
      }

      &:last-child {
        border-top-right-radius: 1rem;
        border-bottom-right-radius: 1rem;
        border-right: none;
      }

      &:hover {
        z-index: 2;
        border-color: rgba(255, 255, 255, 0.3);
      }
    }
  }
}

// ==========================================
// ANIMATIONS
// ==========================================

@keyframes spin-button {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}

@keyframes pulse-glow {
  0%,
  100% {
    box-shadow: 0 6px 20px rgba($accent-color, 0.3),
      inset 0 1px 0 rgba(255, 255, 255, 0.2);
  }
  50% {
    box-shadow: 0 12px 35px rgba($accent-color, 0.5),
      inset 0 1px 0 rgba(255, 255, 255, 0.3);
  }
}

// Classes d'animation optionnelles
.btn-shake {
  animation: shake 0.5s ease-in-out;
}

@keyframes shake {
  0%,
  100% {
    transform: translateX(0);
  }
  25% {
    transform: translateX(-5px);
  }
  75% {
    transform: translateX(5px);
  }
}

// ==========================================
// RESPONSIVE DESIGN
// ==========================================

@media (max-width: 768px) {
  .btn {
    padding: 1.2rem 2rem;
    font-size: 1.5rem;
    gap: 0.8rem;

    &.lg {
      padding: 1.8rem 3rem;
      font-size: 1.7rem;
    }

    &.xl {
      padding: 2rem 3.5rem;
      font-size: 1.8rem;
    }

    &-icon {
      width: 4.5rem;
      height: 4.5rem;
      font-size: 1.8rem;

      &.sm {
        width: 3.5rem;
        height: 3.5rem;
        font-size: 1.4rem;
      }

      &.lg {
        width: 5.5rem;
        height: 5.5rem;
        font-size: 2rem;
      }
    }
  }

  .btn-group {
    flex-direction: column;
    width: 100%;

    .btn {
      border-radius: 0;
      border-right: none;
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);

      &:first-child {
        border-radius: 1rem 1rem 0 0;
      }

      &:last-child {
        border-radius: 0 0 1rem 1rem;
        border-bottom: none;
      }
    }
  }
}

@media (max-width: 480px) {
  .btn {
    padding: 1rem 1.5rem;
    font-size: 1.4rem;

    &.full-width {
      padding: 1.5rem;
    }
  }
}
